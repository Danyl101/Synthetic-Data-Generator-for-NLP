+ Key Takeaways The S&P 500 and Nasdaq added to their all-time highs at midday as investors anticipated more U.S. trade agreements ahead.A deal with regulators opened the door for Hewlett Packard Enterprise to complete its $14 billion purchase of Juniper Networks.Changes in "green" energy tax credits in the Senate budget bill being debated are dragging down shares of AES, NextEra Energy, and Tesla.U.S. equities gained at midday, with the S&P 500 and Nasdaq adding to their all-time highs, on optimism about more U.S. trade deals.The Dow Jones Industrial Average was up as well.Shares of Hewlett Packard Enterprise (HPE) and Juniper Networks (JNPR) were among the best-performing stocks in the S&P 500 after the two tech firms and federal regulators came to an agreement that will allow Hewlett Packard Enterprise to complete its $14 billion purchase of Juniper.Goldman Sachs (GS) was among the large banks whose shares rose following the Federal Reserve's annual stress tests, which showed those institutions could easily withstand a major recession.Moderna (MRNA) shares advanced when the vaccine maker reported positive results from a late-stage study of its experimental flu shot.Fortive (FTV) shares fell when the maker of professional and engineering products completed the spinoff of its Precision Technologies segment and warned macroeconomic conditions would negatively impact revenue.The spinoff took the name Ralliant and will trade under the ticker symbol "RAL."Shares of renewable energy providers AES (AES) and NextEra Energy (NEE) slumped when the latest version of the Senate budget bill called for the phasing out of tax credits for big wind and solar projects faster than earlier versions of the legislation.The bill also would end tax credits for electric vehicle purchases after September, sending shares of EV manufacturer Tesla (TSLA) lower.Thollar was slightly higher versus the pound, but lost ground to the euro and yen.Bitcoin was little changed but most other major cryptocurrencies traded in the green.